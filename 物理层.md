# 物理层主要任务

定义传输媒体接口的标准：机械特性、电气特性、功能特性、规程特性。

# 数据通信基础知识

数据data：传送信息的实体，通常是有意义的符号序列  
信号：数据的电气/电磁的表现，是数据在传输过程中的存在方式。  
数字信号/离散信号：代表信号参数的取值是离散的  
模拟信号/联系信号：代表信号参数的取值是连续的  
信宿：接收数据的终点  
信道：信号的传输媒介。一般用来表示向一个方向
传送信息的介质，因此一条通信线路往往包含一条发送信道和一条接受信道，按传输信号分为：模拟、数字信道，按传输介质分为：有线、无线信道。

## 三种通信方式

### 单工通信

单向通信，只有一条信道

### 半双工/双向交替通信

双向通信，但任何一方不能同时发送和接收，需要两条信道

### 全双工通信/双向同时通信

通信双方可以同时发送和接收信息，需要两条信道

## 传输方式

- 串行传输：按高位到低位依次发送
- 并行传输：一个字符的八位二进制通过八道信道传输（近距离，费用贵）
- 同步传输：数据的传输以区块为单位，因此又称区块传输。在传输数据需先送出1或多个同步字符，再送出整批数据
- 异步传输：将比特分组，发送方随时可以发送，接受方不知道什么时候到达。传输数据时，加一个字符起始位和一个终止位。

## 码元

码元是固定时长的信号波形，在固定时长内的信号称为k进制码元，时长称为码元宽度，离散状态有M个则M进制码元，携带$log_2(M)$比特信息。

## 数据传输速率的表示方法

- 码元传输速率：单位时间传输的码元个数，单位波特（B）（与进制无关）
- 信息传输速率：单位时间传输的二进制码元个数（即比特每秒）
- 若一码元携带n bit，则M B的码元传输速率换算为M*n bit/s

## 带宽

- 在模拟信号系统中：信号最高频率与最低频率的差值
- 在数字设备：表示传输数据的能力，比特每秒

## 奈氏准则

- 码间串扰：接收端收到的信号波形失去了码元之间清晰界限的现象。
- 奈氏准则：在理想低通（无噪声、带宽受限）条件，为了避免码间串扰，极限码元传输速率为2W B，W是信道带宽（HZ）。
- 极限数据传输率=$2Wlog_2(V)(b/s)$ V进制码元 。

### 总结：

- 信道带宽越大，就可以用更高的速率进行码元的有效传输
- 奈氏只限制了码元传输速率，因此提供数据传输速率，要让码元携带更多比特。

## 香农定理

- 信噪比：信号的平均功率/噪声的平均功率，S/N，以dB为单位=$10log_{10}(S/N)$
- 香农定理：在带宽受限且有噪声的信道中，为了不产生误差，信息的数据传输速率有上限。
- 香农公式：极限传输速率 = $Wlog_2(1+S/N)$(b/s)

## 编码和调制

- 基带信号：将数字信号1和0以不同的表示，再送到数字信道上去传输。对应**数字信道**
- 宽度信号：将基带信号进行调制后形成频分复用模拟信号。将基带信号进行载波调制，把频率移到较高的频段以便在在信道中传输。
- 编码 ：数字-> 数字信号
- 调制 ：数据-> 模拟信号 

### 数字数据编码成数字信号

#### 非归零编码

高电平为1，低电平为0，编码易实现，无检错能力，无法判断开始结束

#### 归零编码

信号电平在一个码元内都要恢复成零

#### 反向不归零编码

信号电平翻转表示0，不变表示1；

#### 曼彻斯特编码

一个码元分成两个间隔，前高后低，前低后高分别为0，1；数据传输速率只有调制速率的1/2；

#### 差分曼彻斯特编码

后半个码元和前半个码元，同1，异0；

#### 4B/5B编码

编码效率80%。

### 数字数据调制成模拟信号

数字数据调制技术在发送端将数字信号转为模拟信号，而在接收端将模拟信号还原为数字信号，分别对应调制和解调。 

- 调幅:波形有幅度1，无幅度0
- 调频：高频1，低频1
- 调相：相位的调制
- 调幅+调相

### 模拟数据编码成数字信号

需要将模拟音频通过采样、量化转换成有限个数字表示的离散序列

1. 抽样：对模拟信号周期性扫描，为了不失真：$f_{采样频率}>=2f_{信号最高频率}$
2. 量化：把抽样结果按一定标准量化取整
3. 编码；与二进制编码一一对应

### 模拟数据调制模拟信号

为保证传输有效性，可能提高模拟数据的频率 

## 数据交换

### 电路交换

- 原理：数据传输期间，源结点与目的结点之间有一条专用结点构成的物理专用线路，在数据传输结束之前一直保持
- 特点：**独占资源**，用户始终占用端到端的固定传输带宽，适用于**远距离**、**批处理**或**系统间实时性要求高**的的大量数据传输的情况

|优点|缺点|
|----|----|
|传输时延小|建立连接时间长|
|实时性强，双方一旦建立物理通路便可以实时通信|灵活性差，一旦出现故障得重新连接|
|全双工通信，没有冲突，通信双方都有不同信道|无数据存储能力，难以平滑通信量|
|适用于模拟信号和数字信号|电路交换时，数据直达，不同类型、不同规格、不同速率的终端很难相互进行通信|
控制简单|无法发现与纠正差错，难以进行差错控制|

### 报文交换

- 报文：单次要发生的数据块
- 原理： 存储转发
  
|优点|缺点|
|---|---|
|无需建立连接，无建立连接时延，用户可随时发送报文。|实时性差，不适合传送实时或交互式业务的数据。数据进入交换口点后要经历存储转发过程，从而引起转发时延。|
|动态分配线路，动态选择报文通过的最佳路径，可以平滑信号量。|只适用于数字信号|
|提高线路可靠性，某条传输路径发生故障，可重新选择另一条路径传输。|由于报文长度没有限制，而每个中间结点都要完整地接收传来的整个报文，当输出线路不空闲时，还可能要存储几个完整报文等待转发，要求网络中每个结点有较大的缓冲区。为了降低成本，减少口点的缓冲存储器的容量，有时要把等待转发的报文存在磁盘上，进一步增加了传送时延。|
|提高线路利用率，通信双方在不同的时间一段一段地 部分占有这条物理信道，多个报文可共享信道。||
|提供多目标服务:一个报文可同时发往多个目的地址。||
|在存储转发中容易实现代码转换和速率匹配，甚至收
发双方可以不同时处于可用状态。这样就便于类型、
规格和速度不同的计算机之间进行通信。||


### 分组交换

- 分组：实际上把数据分割成小块，然后逐块发送，这些小块就是组。
- 原理： 限制传输单位大小。以分组为单位进行传输和交换

#### 数据报方式

1. 源主机（A）将报文分组，依次发送
2. 结点A收到分组，对每个分组进行**差错检测**和**路由选择**
3. 结点C收到分组P1后，对该分组进行差错检测，若正确发送确认信息，A收到确认则丢弃P1副本
4. 所有分组到达终点B

特点：

1. 无连接服务（路径随机），发送方随时发送，结点随时接收
2. 可能发生乱序，重复，丢失
3. 每个分组必须携带源地址，目的地址以及分组号
4. 分组在交换节点，需要排队等待处理，会带来时延
5. 网络存在冗余路径，当某一交换结点或某一链路出现故障时，可以相应的更新转发表，寻找另一条路径转发分组，对故障的适应能力强，适用于突发通信，不适于长报文，会话式通信。

#### 虚电路方式

虚电路：一条源主机到目的主机类似于电路的路径（逻辑连接），路径上所有结点都要维持这条虚电路的建立，都维持一张虚电路表，每个记录打开的虚电路的信息。

```mermaid
graph LR
A(建立连接 虚电路建立);
B[数据传输];
C[释放连接];
A --> B;
B --"每个分组携带虚电路号，分组号，检验和控制 "--> C;
```

特点：

- 虚电路方式为网络层提供连接服务
- 所有分组按虚电路顺序发送，分组不需携带源地址，目的地址等信息，而携带虚电路号，相对数据开销小，不会乱序
- 分组提供每个虚电路的节点只进行差错控制
- 每个节点可能与多个节点建立多条虚电路，每条虚电路支持特定的两个端的数据传输，可以对两个端的流量进行控制，两个端系统也可以有多条虚电路为不同的进程服务。

# 传输介质

传输媒体不是物理层（第零层）

## 导向型传输介质  

- 双绞线分为屏蔽双绞线（STP），非屏蔽双绞线（UTP），通信距离端，距离太远一般模拟信号需要通过放大器放大，数字传输需要中继器将失真信号整形。  
- 同轴电缆：基带同轴电缆、宽度同轴电缆  
- 光纤：发送端有光源，带宽大，适合远距离
  
## 非导向型传输介质

- 无线电波  
  向所有方向传播
- 微波  
  固定方向传播
- 红外线，激光  
  信号固定方向传播

# 物理层设备

## 中继器

### 功能

再生数字信号

### 两端

- 两端的网络的部分都是网段，而不是子网，适用于完全相同的两类网络的互连，网段速率相同
- 可连相同媒体或不同媒体
- 必须协议相同

### 5-4-3规则

5网段4设备3计算机

## 集线器（多口中继器）

### 功能

对信号放大再生，转发到其他所有（除输入输出）处于工作状态的端口，共享设备

